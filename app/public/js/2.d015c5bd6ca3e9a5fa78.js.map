{"version":3,"sources":["webpack:///src/components/imgLibs.vue","webpack:///./src/components/imgLibs.vue?29bb","webpack:///./src/components/imgLibs.vue"],"names":["imgLibs","components","GetUserData","data","slide","slideUploadUrl","files","uploadData","urlJurisdiction","window","location","hash","replace","disabled","userid","admin","adminlevel","created","this","userInfo","$store","state","level","methods","getSetUser","user","id","slideChange","_this","raw","type","$refs","clearFiles","alerter","name","size","reader","FileReader","readAsDataURL","onload","push","file","url","result","slideRemove","item","i","fileList","filter","items","index","uid","splice","saveSlide","length","formData_","FormData","map","append","api","libsimg","split","$post","headers","x-csrf-token","getCatch","content-type","config","success","res","code","$router","alertsu","msg","errror","components_imgLibs","render","_vm","_h","$createElement","_c","_self","staticClass","_v","attrs","label-position","panelLayout","label-width","gutter","lg","label","getUserIdFn","_e","slot","ref","drag","action","file-list","on-change","auto-upload","with-credentials","on-remove","list-type","multiple","on","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"gIAyDAA,GACAC,YACAC,sBAAA,GAEAC,KAJA,WAKA,OACAC,OACAD,QACAE,eAAA,GACAC,SACAC,YACAC,gBAAAC,OAAAC,SAAAC,KAAAC,QAAA,SAEAC,UAAA,GAEAC,OAAA,EACAC,OAAA,EACAC,WAAA,IAGAC,QApBA,WAqBAC,KACAC,SADAD,KACAE,OAAAC,MAAAF,SADAD,KAEAF,WAFAE,KAEAC,SAFAD,KAEAC,SAAAG,MAAA,EAFAJ,KAGAC,UACA,IAJAD,KAIAC,SAAAG,QAJAJ,KAKAH,OAAA,IAIAQ,SACAC,WADA,SACAC,GACAP,KAAAJ,OAAAW,EAAAC,IAEAC,YAJA,SAIArB,GACA,IAAAsB,EAAAV,KACA,iBAAAZ,EAAAuB,IAAAC,MAAA,eAAAxB,EAAAuB,IAAAC,MAAA,cAAAxB,EAAAuB,IAAAC,KAGA,OAFAZ,KAAAa,MAAA3B,MAAA4B,aACAJ,EAAAK,QAAA,0BACA,EAEA,GAAA3B,EAAA4B,MACA5B,EAAA6B,KAAA,aAGA,OAFAjB,KAAAa,MAAA3B,MAAA4B,aACAJ,EAAAK,QAAA,kBACA,EAGA,IAAAG,EAAA,IAAAC,WACAD,EAAAE,cAAAhC,EAAAuB,KACAO,EAAAG,OAAA,WACAX,EAAAxB,MAAAD,KAAAqC,MAAAN,KAAA5B,EAAA4B,KAAAO,KAAAnC,EAAAuB,IAAAa,IAAAN,EAAAO,WAGAC,YAxBA,SAwBAC,GACA,IAAAC,EACA5B,KAAAa,MAAA3B,MAAA2C,SAAAC,OAAA,SAAAC,EAAAC,GACA,GAAAD,EAAAE,KAAAN,EAAAM,IAEA,OADAL,EAAAI,GACA,IAGAhC,KAAAa,MAAA3B,MAAA2C,SAAAK,OAAAN,EAAA,GACA5B,KAAAd,MAAAD,KAAAe,KAAAa,MAAA3B,MAAA2C,UAEAM,UAnCA,WAoCA,IAAAzB,EAAAV,KACA,GAAAA,KAAAa,MAAA3B,MAAA2C,SAAAO,QAAA,EAEA,OADA1B,EAAAK,QAAA,gBACA,EAEA,IAIAS,EAJAa,EAAA,IAAAC,SACAtC,KAAAa,MAAA3B,MAAA2C,SAAAU,IAAA,SAAAZ,EAAAK,GACAK,EAAAG,OAAA,OAAAR,EAAAL,EAAAJ,QAGAC,EAAAd,EAAA+B,IAAAC,QAAA,oBAAAnD,OAAAC,SAAAC,KAAAC,QAAA,QAAAiD,MAAA,mBAAA3C,KAAAJ,OAAA,eAAAI,KAAAF,WACAY,EAAAkC,OACApB,MACAvC,MACAoD,YACAQ,SACAC,eAAApC,EAAAqC,SAAArC,EAAA,aACAsC,eAAA,oCAGAC,UAGAC,QAZA,SAYAC,GACA,KAAAA,EAAAlE,KAAAmE,MACA1C,EAAA2C,QAAA/B,MACAN,KAAA,gBAEAN,EAAA4C,QAAAH,EAAAlE,KAAAsE,MAEA7C,EAAAK,QAAAoC,EAAAlE,KAAAsE,MAGAC,OAtBA,kBCnIAC,GADiBC,OAFjB,WAA0B,IAAAC,EAAA3D,KAAa4D,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,cAAwBF,EAAA,MAAAH,EAAAM,GAAA,KAAAN,EAAA,MAAAG,EAAA,WAAiDI,OAAOC,iBAAAnE,KAAAE,OAAAC,MAAAiE,YAAAC,cAAA,WAAsEP,EAAA,UAAeI,OAAOI,OAAA,MAAaR,EAAA,UAAeI,OAAOK,GAAA,KAAQT,EAAA,gBAAqBI,OAAOM,MAAA,WAAiBV,EAAA,iBAAsBI,OAAOO,YAAAd,EAAArD,eAA8B,eAAAqD,EAAAe,KAAAf,EAAAM,GAAA,KAAAH,EAAA,WAAqDE,YAAA,aAAuBF,EAAA,OAAYE,YAAA,WAAAE,OAA8BS,KAAA,UAAgBA,KAAA,WAAeb,EAAA,QAAAA,EAAA,KAAqBE,YAAA,oBAA8BL,EAAAM,GAAA,YAAAN,EAAAM,GAAA,KAAAH,EAAA,WAA+CI,OAAOC,iBAAAnE,KAAAE,OAAAC,MAAAiE,YAAAC,cAAA,WAAsEP,EAAA,UAAeI,OAAOI,OAAA,MAAaR,EAAA,UAAeI,OAAOK,GAAA,MAAST,EAAA,gBAAqBI,OAAOM,MAAA,UAAgBV,EAAA,aAAkBc,IAAA,QAAAZ,YAAA,cAAAE,OAA6CW,KAAA,GAAAC,OAAAnB,EAAAzE,MAAAC,eAAA4F,YAAApB,EAAAzE,MAAAD,KAAA+F,YAAArB,EAAAlD,YAAAwE,eAAA,EAAAC,oBAAA,EAAAjG,KAAA0E,EAAAzE,MAAAG,WAAA8F,YAAAxB,EAAAjC,YAAA0D,YAAA,UAAAzF,WAAAgE,EAAAzE,MAAAS,SAAA0F,SAAA,MAAyRvB,EAAA,KAAUE,YAAA,mBAA6BL,EAAAM,GAAA,KAAAH,EAAA,OAAwBE,YAAA,oBAA8BL,EAAAM,GAAA,aAAAH,EAAA,MAAAH,EAAAM,GAAA,YAAAN,EAAAM,GAAA,KAAAH,EAAA,OAAwEE,YAAA,iBAAAE,OAAoCS,KAAA,OAAaA,KAAA,QAAYhB,EAAAM,GAAA,2CAAAN,EAAAM,GAAA,KAAAH,EAAA,UAA6EI,OAAOI,OAAA,MAAaR,EAAA,UAAeI,OAAOK,GAAA,MAAST,EAAA,gBAAqBI,OAAOM,MAAA,MAAYV,EAAA,aAAkBI,OAAOtD,KAAA,WAAiB0E,IAAKC,MAAA5B,EAAAxB,aAAuBwB,EAAAM,GAAA,mCAElnDuB,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACA7G,EACA2E,GATA,EAVA,SAAAmC,GACAF,EAAA,SAaA,KAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"public/js/2.d015c5bd6ca3e9a5fa78.js","sourcesContent":["<template>\r\n  <div class=\"xzxc-menu\">\r\n  \t<br>\r\n    <el-form v-if=\"admin\" :label-position=\"this.$store.state.panelLayout\" label-width=\"100px\">\r\n      <el-row :gutter=\"24\">\r\n        <el-col :lg=\"8\">\r\n          <el-form-item label=\"选择用户：\">\r\n            <get-user-data :getUserIdFn=\"getSetUser\"></get-user-data> \r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n    </el-form>\r\n  \t<el-card class=\"box-card\">\r\n\t  <div slot=\"header\" class=\"clearfix\">\r\n\t    <span><i class=\"el-icon-picture\"></i>图库上传</span>\r\n\t  </div>\r\n\t  <el-form :label-position=\"this.$store.state.panelLayout\" label-width=\"100px\">\r\n\t\t  <el-row :gutter=\"24\">\r\n\t          <el-col :lg=\"16\">\r\n\t            <el-form-item label=\"幻灯片：\">\r\n\t              <el-upload\r\n\t                ref=\"slide\"\r\n\t                class=\"upload-demo\"\r\n\t                drag\r\n\t                :action=\"slide.slideUploadUrl\"\r\n\t                :file-list=\"slide.data\"\r\n\t                :on-change=\"slideChange\"\r\n\t                :auto-upload=\"false\"\r\n\t                :with-credentials=\"true\"\r\n\t                :data=\"slide.uploadData\"\r\n\t                :on-remove=\"slideRemove\"\r\n\t                list-type=\"picture\"\r\n\t                :disabled=\"slide.disabled ? true : false\"\r\n\t                multiple>\r\n\t                <i class=\"el-icon-upload\"></i>\r\n\t                <div class=\"el-upload__text\">将文件拖到此处，或<em>点击上传</em></div>\r\n\t                <div class=\"el-upload__tip\" slot=\"tip\">只能上传jpg/png文件，且不超过500kb</div>\r\n\t              </el-upload>\r\n\t            </el-form-item>\r\n\t          </el-col>\r\n\t        </el-row>\r\n\r\n\t        <el-row :gutter=\"24\">\r\n\t          <el-col :lg=\"16\">\r\n\t            <el-form-item label=\"\">\r\n\t              <el-button type=\"primary\" @click=\"saveSlide\">确认上传</el-button>\r\n\t            </el-form-item>\r\n\t          </el-col>\r\n\t        </el-row>\r\n\t  </el-form>\r\n\r\n\t</el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport GetUserData from './getUserData'\r\nexport default {\r\n\tcomponents: {\r\n\t  GetUserData,\r\n\t},\r\n  data () {\r\n    return {\r\n      slide: {\r\n        data: [],\r\n        slideUploadUrl: '',\r\n        files: [],\r\n        uploadData:{\r\n          urlJurisdiction: window.location.hash.replace('#','')\r\n        },\r\n        disabled: false\r\n      },\r\n      userid: 0,\r\n      admin: false,\r\n      adminlevel: 0\r\n    }\r\n  },\r\n  created () {\r\n  \tvar _this = this\r\n    _this.userInfo = _this.$store.state.userInfo\r\n    _this.adminlevel =  _this.userInfo ? _this.userInfo.level : 0\r\n    if (_this.userInfo) {\r\n      if (_this.userInfo.level === 1) {\r\n        _this.admin = true\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n  \tgetSetUser (user) {\r\n        this.userid = user.id\r\n    },\r\n  \tslideChange (files) {\r\n  \t  var _this = this\r\n      if (files.raw.type !== 'image/png' && files.raw.type !== 'image/jpeg' && files.raw.type !== 'image/gif'){\r\n        this.$refs.slide.clearFiles()\r\n        _this.alerter('请选择png/jpg/gif格式图片上传！')\r\n        return false\r\n      }\r\n      if (files.name) {\r\n        if (files.size / 1024 / 1024 > 0.5) {\r\n          this.$refs.slide.clearFiles()\r\n          _this.alerter('上传文件不能大于500K！')\r\n          return false\r\n        }\r\n      }\r\n      var reader=new FileReader();\r\n      reader.readAsDataURL(files.raw);\r\n      reader.onload=function(){\r\n        _this.slide.data.push({name: files.name, file: files.raw,url:reader.result}) \r\n      }\r\n  \t},\r\n  \tslideRemove (item) {\r\n  \t  var i\r\n      var file = this.$refs.slide.fileList.filter(function(items, index){\r\n        if (items.uid == item.uid) {\r\n          i = index\r\n          return true\r\n        }\r\n      })\r\n      this.$refs.slide.fileList.splice(i,1)\r\n      this.slide.data = this.$refs.slide.fileList\r\n  \t},\r\n  \tsaveSlide () {\r\n      var _this = this\r\n      if (this.$refs.slide.fileList.length <= 0) {\r\n        _this.alerter('请选择文件再点击上传！')\r\n        return false\r\n      }\r\n      const formData_ = new FormData();\r\n      this.$refs.slide.fileList.map(function(item,index){\r\n        formData_.append('file' + index, item.file)\r\n      })\r\n      var url\r\n      url = _this.api.libsimg + '?urlJurisdiction=' + window.location.hash.replace('#','').split('?')[0] + '&userid=' + this.userid + '&adminlevel=' + this.adminlevel\r\n      _this.$post({\r\n          url: url,\r\n          data: {\r\n            formData_,\r\n            headers: {\r\n              'x-csrf-token': _this.getCatch(_this, 'csrfToken'),\r\n              'content-type': 'application/json; charset=utf-8'\r\n            }\r\n          },\r\n          config: {\r\n            \r\n          },\r\n          success (res){\r\n            if (res.data.code == 200) {\r\n            \t_this.$router.push({\r\n            \t\tname: 'imglibslist'\r\n            \t})\r\n              _this.alertsu(res.data.msg)\r\n            } else {\r\n              _this.alerter(res.data.msg)\r\n            }\r\n          },\r\n          errror () {\r\n\r\n          }\r\n        })\r\n    },\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\">\r\n\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/imgLibs.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"xzxc-menu\"},[_c('br'),_vm._v(\" \"),(_vm.admin)?_c('el-form',{attrs:{\"label-position\":this.$store.state.panelLayout,\"label-width\":\"100px\"}},[_c('el-row',{attrs:{\"gutter\":24}},[_c('el-col',{attrs:{\"lg\":8}},[_c('el-form-item',{attrs:{\"label\":\"选择用户：\"}},[_c('get-user-data',{attrs:{\"getUserIdFn\":_vm.getSetUser}})],1)],1)],1)],1):_vm._e(),_vm._v(\" \"),_c('el-card',{staticClass:\"box-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',[_c('i',{staticClass:\"el-icon-picture\"}),_vm._v(\"图库上传\")])]),_vm._v(\" \"),_c('el-form',{attrs:{\"label-position\":this.$store.state.panelLayout,\"label-width\":\"100px\"}},[_c('el-row',{attrs:{\"gutter\":24}},[_c('el-col',{attrs:{\"lg\":16}},[_c('el-form-item',{attrs:{\"label\":\"幻灯片：\"}},[_c('el-upload',{ref:\"slide\",staticClass:\"upload-demo\",attrs:{\"drag\":\"\",\"action\":_vm.slide.slideUploadUrl,\"file-list\":_vm.slide.data,\"on-change\":_vm.slideChange,\"auto-upload\":false,\"with-credentials\":true,\"data\":_vm.slide.uploadData,\"on-remove\":_vm.slideRemove,\"list-type\":\"picture\",\"disabled\":_vm.slide.disabled ? true : false,\"multiple\":\"\"}},[_c('i',{staticClass:\"el-icon-upload\"}),_vm._v(\" \"),_c('div',{staticClass:\"el-upload__text\"},[_vm._v(\"将文件拖到此处，或\"),_c('em',[_vm._v(\"点击上传\")])]),_vm._v(\" \"),_c('div',{staticClass:\"el-upload__tip\",attrs:{\"slot\":\"tip\"},slot:\"tip\"},[_vm._v(\"只能上传jpg/png文件，且不超过500kb\")])])],1)],1)],1),_vm._v(\" \"),_c('el-row',{attrs:{\"gutter\":24}},[_c('el-col',{attrs:{\"lg\":16}},[_c('el-form-item',{attrs:{\"label\":\"\"}},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.saveSlide}},[_vm._v(\"确认上传\")])],1)],1)],1)],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7421b90e\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/imgLibs.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7421b90e\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./imgLibs.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./imgLibs.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./imgLibs.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7421b90e\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./imgLibs.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/imgLibs.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}